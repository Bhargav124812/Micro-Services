<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/inventory-service/src/main/java/com/microservice/inventory_service/controller/ProductController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/inventory-service/src/main/java/com/microservice/inventory_service/controller/ProductController.java" />
              <option name="originalContent" value="package com.microservice.inventory_service.controller;&#10;&#10;&#10;import com.microservice.inventory_service.dto.OrderRequestDto;&#10;import com.microservice.inventory_service.dto.ProductDto;&#10;import com.microservice.inventory_service.service.Productservice;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.cloud.client.ServiceInstance;&#10;import org.springframework.cloud.client.discovery.DiscoveryClient;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.client.RestClient;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/products&quot;)&#10;@RequiredArgsConstructor&#10;@Slf4j&#10;public class ProductController {&#10;&#10;    private final Productservice productService;&#10;    private final DiscoveryClient discoveryClient;&#10;    private final RestClient restClient;&#10;&#10;    @GetMapping(&quot;/fetchOrders&quot;)&#10;    public String fetchOrderService(HttpServletRequest httpServletRequest){&#10;&#10;        log.info(httpServletRequest.getHeader(&quot;x-custom-header&quot;));&#10;        ServiceInstance orderService= discoveryClient.getInstances(&quot;order-service&quot;).getFirst();&#10;&#10;        return restClient.get()&#10;                .uri(orderService.getUri()+&quot;/orders/core/helloOrders&quot;)&#10;                .retrieve()&#10;                .body(String.class);&#10;    }&#10;&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;ProductDto&gt;&gt; getAllInventory() {&#10;        List&lt;ProductDto&gt; inventories = productService.getAllInventory();&#10;        return ResponseEntity.ok(inventories);&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;ProductDto&gt; getInventoryById(@PathVariable Long id) {&#10;        ProductDto inventory = productService.getProductById(id);&#10;        return ResponseEntity.ok(inventory);&#10;    }&#10;&#10;    @PutMapping(&quot;/reduce-stocks&quot;)&#10;    public ResponseEntity&lt;Double&gt;reduceStock(@RequestBody OrderRequestDto orderRequestDto){&#10;        Double totalPrice = productService.reduceStocks(orderRequestDto);&#10;        return ResponseEntity.ok(totalPrice);&#10;    }&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.microservice.inventory_service.controller;&#10;&#10;&#10;import com.fasterxml.jackson.databind.JsonNode;&#10;import com.fasterxml.jackson.databind.ObjectMapper;&#10;import com.fasterxml.jackson.core.type.TypeReference;&#10;import com.microservice.inventory_service.dto.OrderRequestDto;&#10;import com.microservice.inventory_service.dto.OrderRequestItemDto;&#10;import com.microservice.inventory_service.dto.ProductDto;&#10;import com.microservice.inventory_service.service.Productservice;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.cloud.client.ServiceInstance;&#10;import org.springframework.cloud.client.discovery.DiscoveryClient;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.client.RestClient;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/products&quot;)&#10;@RequiredArgsConstructor&#10;@Slf4j&#10;public class ProductController {&#10;&#10;    private final Productservice productService;&#10;    private final DiscoveryClient discoveryClient;&#10;    private final RestClient restClient;&#10;    private final ObjectMapper objectMapper = new ObjectMapper();&#10;&#10;    @GetMapping(&quot;/fetchOrders&quot;)&#10;    public String fetchOrderService(HttpServletRequest httpServletRequest){&#10;&#10;        log.info(httpServletRequest.getHeader(&quot;x-custom-header&quot;));&#10;        ServiceInstance orderService= discoveryClient.getInstances(&quot;order-service&quot;).getFirst();&#10;&#10;        return restClient.get()&#10;                .uri(orderService.getUri()+&quot;/orders/core/helloOrders&quot;)&#10;                .retrieve()&#10;                .body(String.class);&#10;    }&#10;&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;ProductDto&gt;&gt; getAllInventory() {&#10;        List&lt;ProductDto&gt; inventories = productService.getAllInventory();&#10;        return ResponseEntity.ok(inventories);&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;ProductDto&gt; getInventoryById(@PathVariable Long id) {&#10;        ProductDto inventory = productService.getProductById(id);&#10;        return ResponseEntity.ok(inventory);&#10;    }&#10;&#10;    @PutMapping(&quot;/reduce-stocks&quot;)&#10;    public ResponseEntity&lt;Double&gt; reduceStock(@RequestBody JsonNode payload) {&#10;        try {&#10;            OrderRequestDto orderRequestDto;&#10;            if (payload.isArray()) {&#10;                List&lt;OrderRequestItemDto&gt; items = objectMapper.convertValue(payload, new TypeReference&lt;List&lt;OrderRequestItemDto&gt;&gt;() {});&#10;                orderRequestDto = new OrderRequestDto();&#10;                orderRequestDto.setItems(items);&#10;            } else {&#10;                orderRequestDto = objectMapper.treeToValue(payload, OrderRequestDto.class);&#10;            }&#10;&#10;            Double totalPrice = productService.reduceStocks(orderRequestDto);&#10;            return ResponseEntity.ok(totalPrice);&#10;        } catch (Exception ex) {&#10;            log.error(&quot;Failed to parse reduce-stocks payload&quot;, ex);&#10;            return ResponseEntity.badRequest().build();&#10;        }&#10;    }&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/order-service/order-service/src/main/java/com/microservice/order_service/controller/OrderController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/order-service/order-service/src/main/java/com/microservice/order_service/controller/OrderController.java" />
              <option name="originalContent" value="package com.microservice.order_service.controller;&#10;&#10;&#10;import com.microservice.order_service.dto.OrderRequestDto;&#10;import com.microservice.order_service.service.OrderService;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/core&quot;)&#10;@RequiredArgsConstructor&#10;@Slf4j&#10;public class OrderController {&#10;&#10;    private final OrderService orderService;&#10;&#10;    @GetMapping(&quot;/helloOrders&quot;)&#10;    public String helloOrders() {&#10;        return &quot;Hello from Orders Service&quot;;&#10;    }&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;OrderRequestDto&gt;&gt; getAllOrders(HttpServletRequest httpServletRequest) {&#10;        log.info(&quot;Fetching all orders via controller&quot;);&#10;        List&lt;OrderRequestDto&gt; orders = orderService.getAllOrders();&#10;        return ResponseEntity.ok(orders);  // Returns 200 OK with the list of orders&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;OrderRequestDto&gt; getOrderById(@PathVariable Long id) {&#10;        log.info(&quot;Fetching order with ID: {} via controller&quot;, id);&#10;        OrderRequestDto order = orderService.getOrderById(id);&#10;        return ResponseEntity.ok(order);  // Returns 200 OK with the order&#10;    }&#10;&#10;    @PostMapping(&quot;/create-order&quot;)&#10;    public ResponseEntity&lt;OrderRequestDto&gt; createOrder(@RequestBody OrderRequestDto orderRequestDto) {&#10;        OrderRequestDto orderRequestDto1 = orderService.createOrder(orderRequestDto);&#10;        return ResponseEntity.ok(orderRequestDto1);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.microservice.order_service.controller;&#10;&#10;&#10;import com.fasterxml.jackson.core.type.TypeReference;&#10;import com.fasterxml.jackson.databind.JsonNode;&#10;import com.fasterxml.jackson.databind.ObjectMapper;&#10;import com.microservice.order_service.dto.OrderRequestDto;&#10;import com.microservice.order_service.dto.OrderRequestItemDto;&#10;import com.microservice.order_service.service.OrderService;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/core&quot;)&#10;@RequiredArgsConstructor&#10;@Slf4j&#10;public class OrderController {&#10;&#10;    private final OrderService orderService;&#10;    private final ObjectMapper objectMapper = new ObjectMapper();&#10;&#10;    @GetMapping(&quot;/helloOrders&quot;)&#10;    public String helloOrders() {&#10;        return &quot;Hello from Orders Service&quot;;&#10;    }&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;OrderRequestDto&gt;&gt; getAllOrders(HttpServletRequest httpServletRequest) {&#10;        log.info(&quot;Fetching all orders via controller&quot;);&#10;        List&lt;OrderRequestDto&gt; orders = orderService.getAllOrders();&#10;        return ResponseEntity.ok(orders);  // Returns 200 OK with the list of orders&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;OrderRequestDto&gt; getOrderById(@PathVariable Long id) {&#10;        log.info(&quot;Fetching order with ID: {} via controller&quot;, id);&#10;        OrderRequestDto order = orderService.getOrderById(id);&#10;        return ResponseEntity.ok(order);  // Returns 200 OK with the order&#10;    }&#10;&#10;    @PostMapping(&quot;/create-order&quot;)&#10;    public ResponseEntity&lt;OrderRequestDto&gt; createOrder(@RequestBody JsonNode payload) {&#10;        try {&#10;            OrderRequestDto orderRequestDto;&#10;            if (payload.isArray()) {&#10;                List&lt;OrderRequestItemDto&gt; items = objectMapper.convertValue(payload, new TypeReference&lt;List&lt;OrderRequestItemDto&gt;&gt;() {});&#10;                orderRequestDto = new OrderRequestDto();&#10;                orderRequestDto.setItems(items);&#10;            } else {&#10;                orderRequestDto = objectMapper.treeToValue(payload, OrderRequestDto.class);&#10;            }&#10;&#10;            OrderRequestDto orderRequestDto1 = orderService.createOrder(orderRequestDto);&#10;            return ResponseEntity.ok(orderRequestDto1);&#10;        } catch (Exception ex) {&#10;            log.error(&quot;Failed to parse create-order payload&quot;, ex);&#10;            return ResponseEntity.badRequest().build();&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>